<%- include('../tela') %>

  <head>
    <link rel="stylesheet" href="/css/editarAluno.css">
  </head>


  <body>
    <div class="container">
      <h1>Editar Aluno</h1>

      <form action="/alunos/editar/<%= aluno._id %>" method="POST" enctype="multipart/form-data">
        <div>
          <label>Nome:</label>
          <input type="text" name="nome" value="<%= aluno.nome %>" required>
        </div>

        <div>
          <label for="turma">Turma:</label><br>
          <select name="turma" id="turma" required>
            <option value="" disabled>Selecione uma turma</option>
            <% turmas.forEach(function(turma) { %>
              <option value="<%= turma._id %>" <%=aluno.turma && String(aluno.turma._id)===String(turma._id)
                ? 'selected' : '' %>>
                <%= turma.nome %>
              </option>
              <% }) %>
          </select>
        </div>

        <!-- üì∏ Foto -->
        <div>
          <label for="foto">Foto do Aluno:</label>
          <input type="file" name="foto" id="foto" accept="image/*">
          <% if (aluno.foto) { %>
            <p>Foto atual:</p>
            <img src="<%= aluno.foto.startsWith('http') ? aluno.foto : '/uploads/alunos/' + aluno.foto %>"
              alt="Foto do aluno" style="width:100px; border-radius:5px;">
            <% } %>
        </div>

        <!-- üß† Necessidade Especial -->
        <div>
          <label>Necessidades Especiais:</label><br>
          <div id="necessidadeE-container">
            <% (aluno.necessidadeE || []).forEach(item=> { %>
              <input type="text" name="necessidadeE[]" value="<%= item %>" placeholder="Necessidade especial">
              <% }) %>
                <input type="text" name="necessidadeE[]" placeholder="Necessidade especial">
          </div>
          <button type="button"
            onclick="adicionarInput('necessidadeE-container', 'Necessidade especial')">Adicionar</button>
        </div>

        <!-- ‚ù§Ô∏è Problema de Sa√∫de -->
        <div>
          <label>Problemas de Sa√∫de:</label><br>
          <div id="problemaSaude-container">
            <% (aluno.problemaSaude || []).forEach(item=> { %>
              <input type="text" name="problemaSaude[]" value="<%= item %>" placeholder="Problema de sa√∫de">
              <% }) %>
                <input type="text" name="problemaSaude[]" placeholder="Problema de sa√∫de">
          </div>
          <button type="button"
            onclick="adicionarInput('problemaSaude-container', 'Problema de sa√∫de')">Adicionar</button>
        </div>

        <!-- ‚öôÔ∏è Dificuldade Disciplinar -->
        <div>
          <label>Dificuldades Disciplinares:</label><br>
          <div id="disciplinaD-container">
            <% (aluno.disciplinaD || []).forEach(item=> { %>
              <input type="text" name="disciplinaD[]" value="<%= item %>" placeholder="Dificuldade disciplinar">
              <% }) %>
                <input type="text" name="disciplinaD[]" placeholder="Dificuldade disciplinar">
          </div>
          <button type="button"
            onclick="adicionarInput('disciplinaD-container', 'Dificuldade disciplinar')">Adicionar</button>
        </div>

        <!-- Transfer√™ncia -->
        <div>
          <label>Transfer√™ncia de onde:</label>
          <input type="text" name="transferenciaOnde" value="<%= aluno.transferenciaOnde || '' %>"
            placeholder="Nome da escola anterior">
        </div>

        <div>
          <label>Descri√ß√£o da transfer√™ncia:</label>
          <input type="text" name="transferenciaD" value="<%= aluno.transferenciaD || '' %>"
            placeholder="Motivo ou detalhes">
        </div>

        <!-- Respons√°vel -->
        <div>
          <label>Nome do Respons√°vel:</label>
          <input type="text" name="responsavelNome" value="<%= aluno.responsavelNome || '' %>" required>
        </div>

        <div>
          <label>Contato do Respons√°vel:</label>
          <input type="text" name="responsavelContato" value="<%= aluno.responsavelContato || '' %>" required>
        </div>

        <!-- Segundo Professor -->
        <div>
          <label>
            <input type="checkbox" name="segundoProfessor" <%=aluno.segundoProfessor ? 'checked' : '' %>> Segundo
            Professor
          </label>
          <input type="text" name="segundoProfessorNome" value="<%= aluno.segundoProfessorNome || '' %>"
            placeholder="Nome do segundo professor">
        </div>

        <!-- Observa√ß√£o -->
        <div>
          <label>Observa√ß√£o:</label><br>
          <textarea name="observacao" rows="4" cols="50"
            placeholder="Digite observa√ß√µes adicionais"><%= aluno.observacao || '' %></textarea>
        </div>

        <!-- Bot√µes -->
        <div class="botoes">
          <button type="submit">Salvar altera√ß√µes</button>
          <a class="btn" href="/alunos/">Cancelar</a>
        </div>
      </form>
    </div>
    <script>
      function adicionarInput(containerId, placeholder) {
        const container = document.getElementById(containerId);
        const input = document.createElement('input');
        input.type = 'text';
        input.name = containerId.replace('-container', '[]');
        input.placeholder = placeholder;
        container.appendChild(input);
      }
    </script>
  </body>